# 术语表管理功能

## 功能概述

术语表管理功能允许用户上传、管理和使用术语表来改善翻译质量。系统支持全局术语表和个人术语表，并实现了实时更新机制。

## 主要特性

### 1. 术语表类型
- **全局术语表**: 由管理员创建和管理，所有用户都可以选择使用
- **个人术语表**: 每个用户都可以上传和管理自己的个人术语表

### 2. 权限控制
- **管理员**: 可以上传、下载、更新、删除全局术语表
- **普通用户**: 可以上传、下载、更新、删除自己的个人术语表
- **所有用户**: 可以选择使用全局术语表和个人术语表

### 3. 术语表合并
- 用户可以选择多个全局术语表
- 个人术语表优先级高于全局术语表
- 翻译时自动合并所有选择的术语表

### 4. 实时更新
- 管理员修改术语表后，其他用户刷新页面即可看到更新
- 无需重启服务器
- 每30秒自动检查更新

## 使用方法

### 1. 上传术语表
1. 点击"术语表管理"按钮
2. 选择要上传的CSV文件（格式：src,dst）
3. 填写术语表名称和描述（全局术语表）
4. 点击"上传"按钮

### 2. 选择术语表
1. 在术语表管理界面中
2. 勾选要使用的全局术语表
3. 勾选个人术语表（如果有）
4. 点击"保存选择"

### 3. 管理术语表
- **下载**: 点击下载按钮下载术语表CSV文件
- **更新**: 点击更新按钮上传新的术语表文件
- **删除**: 点击删除按钮删除术语表

## 文件格式

术语表文件必须是CSV格式，包含以下列：
- `src`: 原文
- `dst`: 译文

示例：
```csv
src,dst
API,应用程序接口
CPU,中央处理器
GPU,图形处理器
```

## 技术实现

### 1. 存储结构
```
glossaries/
├── global/           # 全局术语表文件
├── users/           # 用户个人术语表文件
│   └── {username}/
│       └── personal_glossary.csv
└── metadata/        # 元数据文件
    ├── global_glossaries.json
    ├── user_selections.json
    └── versions.json
```

### 2. API接口
- `GET /auth/glossaries`: 获取术语表列表
- `GET /auth/glossaries/check-updates`: 检查更新
- `POST /auth/glossaries/upload`: 上传术语表
- `GET /auth/glossaries/{id}/download`: 下载术语表
- `PUT /auth/glossaries/selection`: 更新用户选择
- `DELETE /auth/glossaries/{id}`: 删除术语表

### 3. 版本控制
- 使用时间戳作为版本号
- 支持增量更新检查
- 前端自动检测更新并通知用户

## 注意事项

1. **文件大小**: 建议术语表文件不超过10MB
2. **术语数量**: 建议单个术语表不超过10000条术语
3. **编码格式**: 文件必须使用UTF-8编码
4. **权限**: 只有管理员可以管理全局术语表
5. **备份**: 建议定期备份重要的术语表文件

## 故障排除

### 1. 上传失败
- 检查文件格式是否为CSV
- 检查文件是否包含src和dst列
- 检查文件编码是否为UTF-8

### 2. 术语表不生效
- 检查是否已保存术语表选择
- 检查术语表是否包含相关术语
- 查看日志确认术语表已加载

### 3. 更新不生效
- 刷新页面
- 检查网络连接
- 查看浏览器控制台错误信息
